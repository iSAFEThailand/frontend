(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1044:function(e,t,n){var content=n(1164);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(54).default)("347e5ec1",content,!0,{sourceMap:!1})},1163:function(e,t,n){"use strict";n(1044)},1164:function(e,t,n){var r=n(53)(!1);r.push([e.i,".working{background-color:#ff6400!important;border-color:#ff6400!important}.pink{background-color:#e94153!important;border-color:#e94153!important}.pink--text{color:#e94153!important}.private{background-color:#0275d8!important;border-color:#0275d8!important}",""]),e.exports=r},1281:function(e,t,n){"use strict";n.r(t);var r,o,c,m,l,d,f,h,_=n(4),y=n(13),main=(n(57),n(66),n(67),n(37),n(47),n(186)),k=n(615),v=n(701),w=n(616),x=n(621),O=n(605),R=n(516),j=n(536),S=n(114),C=(n(588),n(70)),D=n.n(C),U=n(36),P={mixins:[k.a],components:{Navigate:v.a},watch:{time:{handler:function(e,t){this.changeTimeline()}}},computed:{google:main.gmapApi,TimelineItems:function(){return this.profile.pins.map((function(e){return{company_id:e.company_id,mem_company:e.mem_company,disabled:"1"!=e.mem_queue}}))}},data:function(e){var t;return{bottomNav:3,apikey:"",isLoading:!1,message:"",day:[],dialog:!1,dialog_1:!1,dialog_2:!1,dialog_3:!1,dialog_4:!1,dialog_queue:!1,position:{lat:0,lng:0},list_message:[{message:"",updated_at:""}],detail:{chat_id:"",checkin:"",checkout:"",queue_status:"0",member:{check_id:"",mem_id:"",mem_fname:"",mem_lname:"",mem_idcard:"",mem_phone:"",mem_email:"",mem_image:"",mem_company:"",company_phone:"",checkin:{lat:0,lng:0,name:"",addr:"",photo:"",updated_at:""}},company:{check_id:"",company_id:"",mem_company:"",company_phone:"",mem_addr:"",province_name:"",amphur_name:"",district_name:"",mem_zipcode:"",mem_image_logo:"",mem_image_tower:"",mem_fname:"",mem_lname:"",mem_phone:"",check_by:"",temp_date:"",chk_temp:"",temp_status:"",temp:"",note:"",lat:"",lng:"",mem_queue:""}},domain:"",time:["0"],selection:"",checkpoint:{from:"",to:"",lat:"",lng:"",type:"",chk_temp:"",temp_status:"",temp:"",note:""},profile:{checkpoint:{mem_company:"",check_is_temp:"",check_note:"",check_temp:"",temp_status:"",company_phone:""},member:{mem_id:"",mem_fname:"",mem_lname:"",mem_image:""},pins:[]},company:{company_id:"",mem_company:"",mem_image_logo:"",mem_image_tower:""},member:(t={mem_id:"",mem_fname:"",mem_lname:"",mem_sex:"",mem_birthday:"",mem_idcard:"",mem_is_owner:"",mem_is_supervisor:"",mem_is_working:"",mem_owner_name:"",mem_supervisor_name:"",mem_company:"",mem_image:"",mem_token:"",temp:""},Object(y.a)(t,"mem_image",""),Object(y.a)(t,"mem_logo",""),Object(y.a)(t,"mem_tower",""),t),filter_timeline:[{id:1,date:"2020-07-01",timeline:[{time:"19:00",text:"สนามบินอู่ตะเภา",addr:"",photo:"",lat:"",lng:""},{time:"23:00",text:"โรงแรม ดีวารี (D Varee)",addr:"",photo:"",lat:"",lng:""}]},{id:1,date:"2020-07-02",timeline:[{time:"12:00",text:"Central ระยอง",addr:"",photo:"",lat:"",lng:""},{time:"15:00",text:"เกาะเสม๋ด",addr:"",photo:"",lat:"",lng:""},{time:"19:00",text:"โรงแรม ดีวารี (D Varee)",addr:"",photo:"",lat:"",lng:""}]},{id:1,date:"2020-07-03",timeline:[{time:"12:00",text:"สนามบินอู่ตะเภา",addr:"",photo:"",lat:"",lng:""},{time:"15:00",text:"สนามบินเชียงใหม่",addr:"",photo:"",lat:"",lng:""},{time:"​17:00",text:"โรงแรมดอยสุเทพ",addr:"",photo:"",lat:"",lng:""}]}],timeline:[],queue:{queue_id:"",queue_number:0,queue_total:0,queue_wait:0,updated_at:"",queue_status_text:"",color:""}}},methods:{home:function(){this.$router.push("/esafety/quarantine")},logout:function(){if(!confirm("คุณต้องการออกจากระบบหรือไม่ ?"))return!1;S.a.logout(),window.location.href="/"},changeMode:function(e){this.selection=e;"1"==this.selection?""==this.profile.member.select_company||null==this.profile.member.select_company?this.profile.pins[0].company_id:this.profile.member.select_company:this.profile.member.mem_id,D()(w.a.updateSelectWorking,50)(this.profile.member.mem_id,this.selection)},checkQueue:(h=Object(_.a)(regeneratorRuntime.mark((function e(t,n,r,o){var c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.checkQueue(n,r,o);case 2:200==(c=e.sent).status&&null!=c.data&&(t.queue=c.data);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return h.apply(this,arguments)}),saveQueue:function(e,t){var n=this,r={company_id:e,mem_id:this.profile.member.mem_id};D()(O.a.saveQueue)(r),D()(this.makeSaveCheckPoint)(this,e,t),setTimeout((function(){n.$router.push("/esafety/home/queue?selection=2")}),1e3),R.a.saveQueue(e)},makeSaveCheckPoint:(f=Object(_.a)(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.checkpoint.company_id=n,t.checkpoint.type="2",t.checkpoint.to=r,t.checkpoint.from=t.profile.member.mem_id,t.checkpoint.chk_temp="0",t.checkpoint.temp_status="1",t.checkpoint.temp="",t.checkpoint.note="",e.next=10,x.a.saveCheckPoint(t.checkpoint);case 10:e.sent;case 11:case"end":return e.stop()}}),e)}))),function(e,t,n){return f.apply(this,arguments)}),geolocate:function(){var e=this;navigator.permissions.query({name:"geolocation"}).then((function(t){"granted"==t.state&&navigator.geolocation.getCurrentPosition((function(t){e.position={lat:t.coords.latitude,lng:t.coords.longitude},e.markers[0].position=e.center})),t.onchange=function(){console.log("geolocation permission state has changed to ",this.state)}}))},gotoback:function(){this.$router.push("/esafety/home/autoalert")},viewdetail:function(e,t,n,r){if(this.geolocate(),"0"!=t.check_type)if("0"==e&&(this.company.company_id!=t.company_id&&null!=t.company_id?e="1":this.company.company_id==t.company_id?e="2":null==t.company_id&&this.profile.member.mem_id==t.mem_id?e="3":null==t.company_id&&this.profile.member.mem_id==t.check_mem_id&&(e="4")),"1"==e)this.detail.member={type:"",checkin:{name:"",addr:"",photo:"",lat:"",lng:"",updated_at:""}},this.detail.company={type:"1",check_id:t.check_id,company_id:t.company_id,mem_id:t.comp_mem_id,mem_queue:t.mem_queue,mem_company:t.mem_company,company_phone:t.company_phone,mem_province:t.mem_province,mem_addr:t.mem_addr,amphur_name:t.amphur_name,district_name:t.district_name,province_name:t.PROVINCE_NAME,mem_zipcode:t.mem_zipcode,mem_image_logo:t.mem_image_logo,mem_image_tower:t.mem_image_tower,check_by:t.check_mem_fname,temp_date:t.updated_at,chk_temp:t.check_is_temp,temp_status:t.temp_status,temp:t.check_temp,note:t.check_note,lat:t.mem_lat,lng:t.mem_lng,updated_at:""},this.detail.company.mem_image_logo=""==this.detail.company.mem_image_logo||null==this.detail.company.mem_image_logo?"https://image.flaticon.com/icons/svg/2399/2399925.svg":this.domain+"/upload/OTA/logo/"+this.detail.company.mem_image_logo,this.dialog_1=!0,D()(this.getCheckIn,100)(this,t.company_id,t.mem_id,n,r);else{"2"==e||"4"==e?(this.detail.company={type:""},this.detail.member={type:e,check_id:t.check_id,mem_id:t.mem_id,company_id:t.company_id,mem_queue:t.mem_queue,company_phone:t.company_phone,mem_company:t.mem_company,mem_fname:t.mem_fname,mem_lname:t.mem_lname,mem_idcard:t.mem_idcard,mem_sex:t.mem_sex,mem_phone:t.mem_phone,mem_email:t.mem_email,mem_image:t.mem_image,check_by:t.check_mem_fname,temp_date:t.updated_at,chk_temp:t.check_is_temp,temp_status:t.temp_status,temp:t.check_temp,note:t.check_note,mem_is_working:t.mem_is_working,mem_type:t.mem_type,checkin:{name:"",addr:"",photo:"",lat:"",lng:"",updated_at:""}},D()(this.getCheckIn,100)(this,this.company.company_id,t.mem_id,n,r)):"3"==e&&(this.detail.member={type:"3",check_id:t.check_id,mem_id:t.check_mem_id,company_id:t.company_id,mem_queue:t.mem_queue,company_phone:t.company_phone,mem_company:t.mem_company,mem_fname:t.check_mem_fname,mem_lname:t.check_mem_lname,mem_idcard:t.mem_idcard,mem_sex:t.check_mem_sex,mem_phone:t.check_mem_phone,mem_email:t.check_mem_eamil,mem_image:t.check_mem_image,check_by:t.check_mem_fname,temp_date:t.updated_at,chk_temp:t.check_is_temp,temp_status:t.temp_status,temp:t.check_temp,note:t.check_note,mem_is_working:t.check_mem_is_working,mem_type:t.check_mem_type,checkin:{name:"",addr:"",photo:"",lat:"",lng:"",updated_at:""}},D()(this.getCheckIn,100)(this,this.company.company_id,t.check_mem_id,n,r)),this.detail.member.mem_phone&&(this.detail.member.mem_phone=this.detail.member.mem_phone.substr(0,2)+"XXXXX"+this.detail.member.mem_phone.substr(this.detail.member.mem_phone.length-3,3));var o="M"==this.detail.member.mem_sex?"https://image.flaticon.com/icons/svg/145/145859.svg":"https://image.flaticon.com/icons/png/512/145/145866.png";this.detail.member.mem_image=null==this.detail.member.mem_image?"":this.detail.member.mem_image,this.detail.member.mem_image=""==this.detail.member.mem_image?o:this.domain+"/upload/OTA/profile/"+this.detail.member.mem_image,this.dialog_2=!0}else this.detail.member.checkin={name:t.check_name,addr:t.check_addr,photo:t.check_photo,lat:t.check_lat,lng:t.check_lng,updated_at:t.updated_at},this.dialog_4=!0},changeTimeline:function(){var e=this,filter=this.timeline.filter((function(t,n){return e.time==t.id}));filter.length>0&&(this.filter_timeline=filter)},getCheckIn:(d=Object(_.a)(regeneratorRuntime.mark((function e(t,n,r,o,c){var m,data,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.getCheckIn(n,r,o,c);case 2:200==(m=e.sent).status&&(null!=(data=m.data)?(t.detail.checkin=data.created_at,t.detail.checkout=data.updated_at,t.detail.queue_status=data.queue_status):(t.detail.checkin="",t.detail.checkout="",t.detail.queue_status="0")),"1"==t.detail.company.mem_queue&&(l=(new Date).toISOString(),D()(t.checkQueue)(t,n,r,l));case 5:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return d.apply(this,arguments)}),getTimeline:(l=Object(_.a)(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,x.a.getTimeline(n,r);case 3:200==(o=e.sent).status&&(t.timeline=o.data,t.changeTimeline()),t.isLoading=!1;case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return l.apply(this,arguments)}),getProfile:(m=Object(_.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,filter,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,S.a.getProfile(n);case 3:if(200==(r=e.sent).status){o=r.data.pins.filter((function(e,t){return"1"==e.mem_type&&"0"==e.cate_type})),t.profile=r.data,t.profile.pins=o,t.profile.checkpoint=null==t.profile.checkpoint?{mem_company:"",check_is_temp:"",check_note:"",check_temp:"",temp_status:"",company_phone:""}:t.profile.checkpoint;try{c="M"==t.profile.member.mem_sex?"https://image.flaticon.com/icons/svg/145/145859.svg":"https://image.flaticon.com/icons/png/512/145/145866.png",t.profile.member.mem_image=null==t.profile.member.mem_image?"":t.profile.member.mem_image,t.profile.member.mem_image=""==t.profile.member.mem_image?c:t.domain+"/upload/OTA/profile/"+t.profile.member.mem_image,t.profile.pins.length>0&&(""!=t.profile.member.select_company&&null!=t.profile.member.select_company?(filter=t.profile.pins.filter((function(e,n){return e.company_id==t.profile.member.select_company&&"1"==e.mem_type})),t.company=filter.length>0?filter[0]:t.profile.pins[0]):t.company=t.profile.pins[0],t.company.mem_image_logo=""==t.company.mem_image_logo||null==t.company.mem_image_logo?"https://image.flaticon.com/icons/svg/2399/2399925.svg":t.domain+"/upload/OTA/logo/"+t.company.mem_image_logo,t.profile.member.mem_type=t.company.mem_type),null!=t.$route.query.selection?t.selection=t.$route.query.selection:t.profile.member.select_working&&"0"!=t.profile.member.select_working?t.selection=t.profile.member.select_working:"1"==t.profile.member.mem_type&&"1"==t.profile.member.mem_is_working?t.selection="1":t.selection="2",t.selection="2",t.changeMode(t.selection),m="1"==t.selection?t.company.company_id:t.profile.member.mem_id,D()(t.getCountMessageAll)(t,m,t.selection),t.watchChat()}catch(e){console.log(e)}t.isLoading=!1}case 5:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)}),makegetMessage:(c=Object(_.a)(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",r="1"==t.selection?t.company.company_id:t.profile.member.mem_id,t.selection,"1"==t.selection||"3"==t.detail.member.type||"2"==t.detail.member.type||"4"==t.detail.member.type?n=t.detail.member.check_id:"2"==t.selection&&(n=t.detail.company.check_id),e.next=6,j.a.getMessageListUser(r,n);case 6:200==(o=e.sent).status&&(t.list_message=o.data);case 8:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),sendMessage:function(){D()(this.makesendMessage,100)(this)},makeCreateChat:(o=Object(_.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",r="",o="1"==t.selection?t.company.company_id:t.profile.member.mem_id,"1"==t.selection||"3"==t.detail.member.type||"2"==t.detail.member.type||"4"==t.detail.member.type?(n=t.detail.member.mem_id,r="2"):"2"==t.selection&&(n=t.detail.company.company_id,r="1"),c={from_id:o,from_type:t.selection,to_id:n,to_type:r},e.next=7,j.a.createChat(c);case 7:200==(m=e.sent).status&&(t.detail.chat_id=m.data,t.dialog_1=!1,t.dialog_2=!1,t.$router.push("/esafety/home/chat?chat_id="+t.detail.chat_id+"&id="+n+"&type="+r+"&selection="+t.selection));case 9:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)}),makesendMessage:(r=Object(_.a)(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",r="1"==t.selection?t.company.company_id:t.profile.member.mem_id,"1"==t.selection||"3"==t.detail.member.type||"2"==t.detail.member.type||"4"==t.detail.member.type?n=t.detail.member.check_id:"2"==t.selection&&(n=t.detail.company.check_id),o={check_id:n,send_id:r,message:t.message,send_type:t.selection},e.next=6,j.a.sendMessage(o);case 6:200==e.sent.status&&(t.message="",t.firebaseUpdate(n,t.selection)),t.dialog_1=!1,t.dialog_2=!1,t.dialog=!1;case 11:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),viewmessage:function(){D()(this.makeCreateChat,100)(this)},firebaseUpdate:function(e,t){var n=U.a.database();n.ref("/message/"+e).limitToLast(1).once("value").then((function(t){var r=n.ref("/message/"+e);if(null!=t.val()){var o=Object.keys(t.val())[0];null==o?r.push({check_id:e,date:Date.now()}):r.child(o).update({check_id:e,date:Date.now()})}else r.push({check_id:e,date:Date.now()})}))}},mounted:function(){this.apikey="AIzaSyBmQcPSDY0cyPMRTmNBjGALE57jKMCY5GU",this.geolocate();this.domain="https://www.isafetravel.com",this.day=[];for(var i=0;i<=14;i++){var e=new Date;e.setDate(e.getDate()-i),this.day.push(e)}}},E=(n(1163),n(30)),M=n(112),N=n.n(M),A=n(395),T=n(524),F=n(529),J=n(645),Q=n(485),V=n(457),Y=n(773),I=n(651),L=n(567),z=n(525),W=n(969),B=n(970),component=Object(E.a)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",{attrs:{app:""}},[n("v-overlay",{attrs:{value:e.isLoading,absolute:""}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),e._v(" "),n("v-container",{staticClass:"mt-2 mb-10"},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{staticClass:"text-center ma-0",attrs:{cols:"3"}},[n("a",{staticStyle:{"text-decoration":"none"},attrs:{href:"/esafety/home/autoalert"}},[n("v-icon",{attrs:{size:"30",color:"teal darken-2"}},[e._v("mdi-arrow-left")])],1)]),e._v(" "),n("v-col",{staticClass:"text-center ma-0",attrs:{cols:"7"}},[n("label",{staticClass:"orange--text text--darken2 font-weight-bold title"},[e._v("Timeline")])]),e._v(" "),n("v-col",{staticClass:"text-center ma-0",attrs:{cols:"2"}},[n("a",{staticStyle:{"text-decoration":"none"},on:{click:e.logout}},[n("v-icon",{attrs:{size:"30",color:"orange darken-2"}},[e._v("mdi-door-open")])],1)])],1),e._v(" "),n("v-row",[n("v-col",{directives:[{name:"show",rawName:"v-show",value:"2"==e.selection,expression:"selection == '2'"}],staticClass:"ma-0",attrs:{cols:"12",sm:"12"}},[n("h2",{class:"1"!=e.profile.member.mem_is_working?"title font-weight-bold text-center pink--text text--darken-2":"title font-weight-bold blue--text text-center text--darken-2"},[e._v("\n            "+e._s(e.profile.member.mem_fname)+"\n          ")])]),e._v(" "),n("v-col",{directives:[{name:"show",rawName:"v-show",value:"2"==e.selection,expression:"selection == '2'"}],staticClass:"text-center mt-2",attrs:{cols:"12"}},[n("v-btn",{staticClass:"white--text text-center font-weight-bold title",attrs:{color:"green darken-1",link:"",href:"/esafety/autoalert/create"}},[n("v-icon",{attrs:{color:"white"}},[e._v("mdi-map-marker-radius")]),e._v(" Create\n          ")],1)],1)],1),e._v(" "),n("v-row",[n("v-col",{staticClass:"ma-0",staticStyle:{height:"450px",overflow:"auto"},attrs:{cols:"12"}},e._l(e.filter_timeline,(function(t,r){return n("v-timeline",{key:"day_"+r,attrs:{"align-top":"",dense:""}},[n("v-timeline-item",{staticClass:"ma-0",attrs:{"hide-dot":""}},[n("span",{directives:[{name:"show",rawName:"v-show",value:"0"==t.id,expression:"t.id == '0'"}],staticClass:"font-weight-bold red--text text--darken-2"},[e._v("วันนี้")]),e._v(" "),n("h3",{directives:[{name:"show",rawName:"v-show",value:"0"!=t.id,expression:"t.id != '0'"}],staticClass:"font-weight-bold red--text text--darken-2"},[e._v("\n                "+e._s(e._f("formatDate")(t.date))+"\n              ")])]),e._v(" "),e._l(t.timeline,(function(t,r){return n("v-timeline-item",{key:"time_"+r,staticClass:"ma-0",attrs:{color:"pink",small:""}},[n("v-row",{staticClass:"ma-0"},[n("v-col",{staticClass:"ma-0",attrs:{cols:"3"}},[n("strong",[e._v(e._s(t.time))])]),e._v(" "),n("v-col",{staticClass:"ma-0"},[n("v-icon",{attrs:{color:"red"}},[e._v("mdi-map-marker-radius")]),e._v("\n                  "+e._s(t.text)+"\n                ")],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-divider")],1)],1)],1)}))],2)})),1),e._v(" "),n("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[n("v-btn",{staticClass:"white--text text-center font-weight-bold title",attrs:{color:"green darken-1",link:"",href:"/esafety/autoalert/report"}},[e._v("\n            ค้นหากลุ่มเสี่ยง\n          ")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;N()(component,{VApp:A.a,VBtn:T.a,VCol:F.a,VContainer:J.a,VDivider:Q.a,VIcon:V.a,VMain:Y.a,VOverlay:I.a,VProgressCircular:L.a,VRow:z.a,VTimeline:W.a,VTimelineItem:B.a})},516:function(e,t,n){"use strict";var r,o,c,m,l,d,f,h=n(4),_=(n(19),n(85),n(47),n(57),n(36)),y=n(114),k=(n(9),n(70)),v=n.n(k);t.a={getTokenNotification:(f=Object(h.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=_.a.messaging(),console.log(_.a.messaging.isSupported()),_.a.messaging.isSupported()&&_.a.messaging().requestPermission().then((function(){_.a.messaging().getToken().then((function(e){e?(console.log("token",e),localStorage.fcm_token=e,localStorage.notification=!0,t.dialog_notification=!1,localStorage.fcm_token&&v()(y.a.updateUUID)(localStorage.mem_id,localStorage.fcm_token)):console.log("No Instance ID token available. Request permission to generate one.")})).catch((function(e){localStorage.notification=!1,t.dialog_notification=!1,console.log("An error occurred while retrieving token. ",e)})),n.onMessage((function(e){console.log("Message received. ",e)}))})).catch((function(e){console.log("Unable to get permission to notify.",e)}));case 3:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)}),subscribeToTopic:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(h.a)(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=_.a.messaging(),console.log(_.a.messaging.isSupported()),_.a.messaging.isSupported()&&(_.a.messaging(),subscribeToTopic(n,r).then((function(){_.a.messaging().getToken().then((function(e){console.log(e)})).catch((function(e){localStorage.notification=!1,t.dialog_notification=!1,console.log("An error occurred while retrieving token. ",e)})),o.onMessage((function(e){console.log("Message received. ",e)}))})).catch((function(e){console.log("Unable to get permission to notify.",e)})));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),saveQueue:(d=Object(h.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),n=_.a.database(),r=n.ref("/queue/"+t),n.ref("/queue/"+t).orderByChild("company_id").equalTo(t).limitToLast(1).once("value").then((function(e){if(null!=e.val()){var n=Object.keys(e.val())[0];r.child(n).update({company_id:t,date:Date.now()})}else r.push({company_id:t,date:Date.now()})}));case 4:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),sendMessage:(l=Object(h.a)(regeneratorRuntime.mark((function e(t,n,r,o,c){var m,l,image,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m="1"==o?r.company_id:r.mem_id,l="1"==n?t.company_id:t.mem_id,image="1"==n?t.mem_image_logo:t.mem_image,(d=_.a.database()).ref("/chat/"+m).limitToLast(1).once("value").then((function(e){var r=d.ref("/chat/"+m);if(console.log(e.val()),null!=e.val()){var o=Object.keys(e.val())[0];console.log(o,r),r.remove(),r.push({chat_id:c.chat_id,from_id:l,from_name:"1"==n?t.mem_company:t.mem_fname,image:image,message:c.message,read:"0",date:Date.now()})}else r.push({chat_id:c.chat_id,from_id:l,from_name:"1"==n?t.mem_company:t.mem_fname,image:image,message:c.message,read:"0",date:Date.now()})}));case 5:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return l.apply(this,arguments)}),qrscan:(m=Object(h.a)(regeneratorRuntime.mark((function e(t,n,r,o,c){var m,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m="1"==c?"2":"3"==c?"3":"1",l=_.a.database(),d=l.ref("/qrscan/"+n),l.ref("/qrscan/"+n).orderByChild("scan_to").equalTo(n).limitToLast(1).once("value").then((function(e){if(null!=e.val()){var l=Object.keys(e.val())[0];d.child(l).update({scan_from:t,scan_to:n,selection_from:c,selection_to:m,token_from:r,token_to:o,date:Date.now()})}else d.push({scan_from:t,scan_to:n,selection_from:c,selection_to:m,token_from:r,token_to:o,date:Date.now()})}));case 4:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return m.apply(this,arguments)}),qrscan_confirm:(c=Object(h.a)(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_.a.database().ref("/qrscan_confirm/"+n).push({scan_from:t,scan_to:n,selection_from:"",selection_to:"",token_from:r,token_to:o,date:Date.now()});case 3:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return c.apply(this,arguments)}),update_qrscan_confirm:(o=Object(h.a)(regeneratorRuntime.mark((function e(t,n,r,o,c,m){var l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=_.a.database(),d=l.ref("/qrscan_confirm/"+n),l.ref("/qrscan_confirm/"+n).orderByChild("scan_to").equalTo(n).limitToLast(1).once("value").then((function(e){if(null!=e.val()){var l=Object.keys(e.val())[0];d.child(l).update({scan_from:t,scan_to:n,selection_from:r,selection_to:o,token_from:c,token_to:m,date:Date.now()})}}));case 3:case"end":return e.stop()}}),e)}))),function(e,t,n,r,c,m){return o.apply(this,arguments)}),delete_qrscan:(r=Object(h.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_.a.database().ref("/qrscan/"+t).remove();case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}},536:function(e,t,n){"use strict";var r,o,c,m,l,d,f,h,_,y,k,v,w,x,O,R,j,S=n(13),C=n(4),D=(n(73),n(75),n(57),n(9));n(516),n(70);t.a=(r={getChatDetail:(j=Object(C.a)(regeneratorRuntime.mark((function e(t){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/chatdetail/"+t).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)}),getUserChat:(R=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/chat?id="+t+"&type="+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return R.apply(this,arguments)}),getUserChatGroup:(O=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/chat?id="+t+"&type="+n+"&group=1").then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return O.apply(this,arguments)}),getMessageListUser:(x=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/chatbyuser/"+t+"/"+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return x.apply(this,arguments)}),getMessageList:(w=Object(C.a)(regeneratorRuntime.mark((function e(t){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/chat/"+t).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e){return w.apply(this,arguments)}),getCountMessageAll:(v=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/CountMessageAll/"+t+"/"+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)}),readMessage:(k=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.get("/readmessage/"+t+"/"+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return k.apply(this,arguments)}),saveMessageGroup:(y=Object(C.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("chat",JSON.stringify(t)),n.append("group","1"),e.next=5,D.a.post("/chat",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)}),saveMessage:(_=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("chat",JSON.stringify(t)),r.append("group",JSON.stringify(n)),e.next=5,D.a.post("/chat",r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return _.apply(this,arguments)})},Object(S.a)(r,"saveMessageGroup",(h=Object(C.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("chat",JSON.stringify(t)),n.append("group","1"),e.next=5,D.a.post("/chat",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})),Object(S.a)(r,"createChat",(f=Object(C.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("chat",JSON.stringify(t)),e.next=4,D.a.post("/createchat",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 4:return data=e.sent,e.abrupt("return",data);case 6:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})),Object(S.a)(r,"createChatGroup",(d=Object(C.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("group",JSON.stringify(t)),e.next=5,D.a.post("/createchat_group",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})),Object(S.a)(r,"editchatgroup",(l=Object(C.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("chat",JSON.stringify(t)),e.next=5,D.a.post("/editchatgroup",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})),Object(S.a)(r,"addchatmember",(m=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("chat_id",JSON.stringify(t)),r.append("mem_id",JSON.stringify(n)),e.next=6,D.a.post("/addchatmember",r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})),Object(S.a)(r,"deletechatmember",(c=Object(C.a)(regeneratorRuntime.mark((function e(t,n){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("chat_id",JSON.stringify(t)),r.append("mem_id",JSON.stringify(n)),e.next=6,D.a.post("/deletechatmember",r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})),Object(S.a)(r,"sendNotification",(o=Object(C.a)(regeneratorRuntime.mark((function e(t,n,r,o,c,m){var l,d,image,body,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={headers:{"content-type":"application/json",Authorization:"key=AAAA1QF5IC8:APA91bFLc7Vw11Y9zrOTxn7jQd53VS60-iG7uZOJDNZzmMgrlWyWE9FapbXMDYO05kVYFPOZWddgvMu1sAQUfUAGQY-UrAgtheYSrJhYABQSyiEsBD2oi_uYZEoeCgW9ErFw2K3RVMIT"}},"1"==o?r.company_id:r.mem_id,d="1"==n?t.company_id:t.mem_id,image="1"==n?t.mem_image_logo:t.mem_image,m.message=m.message.includes("<img")?"ส่งรูปภาพ":m.message,body={to:r.mem_uuid,notification:{body:"1"==n?t.mem_company+" : "+m.message:t.mem_fname+" : "+m.message,title:localStorage.title,icon:image,click_action:localStorage.domain+"/esafety/link?link=chat&chat_id="+m.chat_id+"&id="+d+"&type="+n+"&selection="+o+"&token="+c,sound:"default"}},e.next=8,D.a.post("https://fcm.googleapis.com/fcm/send",body,l).then((function(e){return e})).catch((function(e){console.log(e)}));case 8:return data=e.sent,e.abrupt("return",data);case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,r,c,m){return o.apply(this,arguments)})),r)},588:function(e,t,n){"use strict";n(37);var r=n(3),o=n(143),c=n.n(o);r.default.filter("formatDateTime",(function(e){if(e)return c()(String(e)).format("DD/MM/YYYY HH:mm")})),r.default.filter("formatDate",(function(e){if(e)return c()(String(e)).format("DD/MM/YYYY")})),r.default.filter("formatLongDate",(function(e){if(e)return c()(String(e)).format("DD MMM")})),r.default.filter("formatShortDate",(function(e){if(e)return c()(String(e)).format("DD/MM/YY")})),r.default.filter("formatTime",(function(e){if(e)return c()(String(e)).format("HH:mm")}))},605:function(e,t,n){"use strict";var r,o,c,m,l,d,f,h,_,y,k,v,w,x,O,R,j,S,C=n(13),D=n(4),U=(n(57),n(9));t.a=(r={guideQueue:(S=Object(D.a)(regeneratorRuntime.mark((function e(t){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.post("/queue_guide/"+t).then((function(e){return e})).catch((function(e){return e}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)}),getday:(j=Object(D.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/queue_day/"+t+"/"+n).then((function(e){return e})).catch((function(e){return e}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return j.apply(this,arguments)}),getQueue:(R=Object(D.a)(regeneratorRuntime.mark((function e(t){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/queue/"+t).then((function(e){return e})).catch((function(e){return e}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e){return R.apply(this,arguments)}),listQueue:(O=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r){var o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("id",JSON.stringify(n)),o.append("type",JSON.stringify(t)),o.append("date",JSON.stringify(r)),e.next=6,U.a.post("/queue_list?",o).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n){return O.apply(this,arguments)}),checkQueue:(x=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/checkqueue/"+t+"/"+n+"/"+r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return x.apply(this,arguments)}),checkoutQueue:(w=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/checkout_queue/"+t+"/"+n+"/"+r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return w.apply(this,arguments)}),saveQueue:(v=Object(D.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("queue",JSON.stringify(t)),n.append("type","S"),e.next=5,U.a.post("/queue",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)}),changeStatus:(k=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r,o,c,m,l,d,f,h){var _,y,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _={id:t,status:n,by:r,lat:o,lng:c,country:m,prov:l,dist:d,sdist:f,zipcode:h},(y=new FormData).append("queue",JSON.stringify(_)),y.append("type","U"),e.next=6,U.a.post("/queue",y).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o,c,m,l,d,f){return k.apply(this,arguments)}),changeCompany:(y=Object(D.a)(regeneratorRuntime.mark((function e(t,n){var r,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={company_id:t,company_name:n,by:by},(o=new FormData).append("company",JSON.stringify(r)),o.append("type","U"),e.next=6,U.a.post("/queue",o).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return y.apply(this,arguments)})},Object(C.a)(r,"changeStatus",(_=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r,o,c,m,l,d,f,h,_,y,k){var v,w,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v={id:t,status:n,by:r,lat:o,lng:c,country:m,prov:l,dist:d,sdist:f,zipcode:h,prov_id:_,dist_id:y,sdist_id:k},(w=new FormData).append("queue",JSON.stringify(v)),w.append("type","U"),e.next=6,U.a.post("/queue",w).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 6:return data=e.sent,e.abrupt("return",data);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o,c,m,l,d,f,h,y,k){return _.apply(this,arguments)})),Object(C.a)(r,"sendNotification",(h=Object(D.a)(regeneratorRuntime.mark((function e(t,n,r){var o,body,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={headers:{"content-type":"application/json",Authorization:"key=AAAA1QF5IC8:APA91bFLc7Vw11Y9zrOTxn7jQd53VS60-iG7uZOJDNZzmMgrlWyWE9FapbXMDYO05kVYFPOZWddgvMu1sAQUfUAGQY-UrAgtheYSrJhYABQSyiEsBD2oi_uYZEoeCgW9ErFw2K3RVMIT"}},body={to:r,notification:{body:t+" เชิญคิวที่ "+n+" รับบริการค่ะ",title:"iSAFE Thailand COVID-19",icon:"https://www.covid19.isafethailand.com/images/icon/logo.png",click_action:"https://www.covid19.isafethailand.com/esafety/link?id=queue",sound:"default"}},e.next=4,U.a.post("https://fcm.googleapis.com/fcm/send",body,o).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 4:return data=e.sent,e.abrupt("return",data);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return h.apply(this,arguments)})),Object(C.a)(r,"sendMessage",(f=Object(D.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("message",JSON.stringify(t)),e.next=4,U.a.post("/queue_message",n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 4:return data=e.sent,e.abrupt("return",data);case 6:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})),Object(C.a)(r,"readMessage",(d=Object(D.a)(regeneratorRuntime.mark((function e(t,n){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("queue_id",t),r.append("type",n),e.next=5,U.a.post("/message_read",r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})),Object(C.a)(r,"listMessage",(l=Object(D.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/queue_message/"+t+"/"+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})),Object(C.a)(r,"alertQueue",(m=Object(D.a)(regeneratorRuntime.mark((function e(t,n){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("mem_id",JSON.stringify(t)),r.append("date",JSON.stringify(n)),e.next=5,U.a.post("/alert_queue",r).then((function(e){return e})).catch((function(e){return e}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})),Object(C.a)(r,"saveAlertQueue",(c=Object(D.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("list",JSON.stringify(t)),e.next=4,U.a.post("/savealert_queue",n).then((function(e){return e})).catch((function(e){return e}));case 4:return data=e.sent,e.abrupt("return",data);case 6:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})),Object(C.a)(r,"listTraveler",(o=Object(D.a)(regeneratorRuntime.mark((function e(t){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.get("/joborder_travelerid/"+t).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})),r)},615:function(e,t,n){"use strict";var r,o=n(4),c=(n(57),n(19),n(85),n(38),n(536)),m=n(36),l=n(70),d=n.n(l),f=n(71),h=n(516);t.a={data:function(){return{chat:{message:"",from_id:"",from_name:"",imagr:"",from_type:"",to_id:"",to_type:""},count_message:0,snackbar:!1,timeout:1e4,color:"blue darken-2"}},methods:{back:function(){var e=this.$route.fullPath;localStorage.esafety_pre_link?localStorage.esafety_pre_link==e?this.$router.push("/esafety/home/main"):this.$router.push(localStorage.esafety_pre_link):this.$router.push("/esafety/home/main")},playSound:function(){new Audio("/sound/pristine.mp3").play()},getCountMessageAll:(r=Object(o.a)(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.getCountMessageAll(n,r);case 2:200==(o=e.sent).status&&(t.count_message=o.data.toString());case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)}),watchChat:function(){var e=this,t="1"==this.selection?this.company.company_id:this.profile.member.mem_id;console.log("watch",t);var n=m.a.database();n.ref("/chat/"+t).on("value",(function(r){null!=r&&r.forEach(function(){var r=Object(o.a)(regeneratorRuntime.mark((function r(o){var data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(data=o.val(),d()(e.getCountMessageAll)(e,t,e.selection),""!=data.message){e.snackbar=!0,e.chat.message=data.message,e.chat.from_name=data.from_name;try{e.playSound()}catch(e){console.log(e)}n.ref("/chat/"+t).remove()}case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))},getlocationSafari:function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(this.showLocation,this.errorHandler,{timeout:6e4})}else alert("Sorry, browser does not support geolocation!")},showLocation:function(e){this.position={lat:e.coords.latitude,lng:e.coords.longitude},localStorage.lat||localStorage.lng?localStorage.lat!==e.coords.latitude&&localStorage.lng!==e.coords.longitude&&(localStorage.lat=e.coords.latitude,localStorage.lng=e.coords.longitude):(localStorage.lat=e.coords.latitude,localStorage.lng=e.coords.longitude);f.a.getDevice();console.log(localStorage.lat,localStorage.lng)},errorHandler:function(e){1==e.code?alert("Error: Access is denied!"):2==e.code&&alert("Error: Position is unavailable!"),this.isLoading=!1}},mounted:function(){f.a.setUrl(this),this.getlocationSafari(),h.a.getTokenNotification(this)}}},616:function(e,t,n){"use strict";var r,o,c,m,l,d,f=n(4),h=(n(57),n(27),n(9)),_="qeasymenu";t.a={addWorking:(d=Object(f.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("working",JSON.stringify(t)),n.append("type","I"),n.append("image_logo",t.logo),n.append("image_tower",t.tower),e.next=7,h.a.post("/editworking?name="+_,n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 7:return data=e.sent,e.abrupt("return",data);case 9:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),updateWorking:(l=Object(f.a)(regeneratorRuntime.mark((function e(t){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("working",JSON.stringify(t)),n.append("type","U"),n.append("image_logo",t.logo),n.append("image_tower",t.tower),e.next=7,h.a.post("/editworking?name="+_,n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 7:return data=e.sent,e.abrupt("return",data);case 9:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)}),deleteWorking:(m=Object(f.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)({method:"get",url:"/deleteworking/"+t+"/"+n}).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)}),updateSelectCompany:(c=Object(f.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)({method:"get",url:"/updateselectcompany/"+t+"/"+n}).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)}),updateSelectWorking:(o=Object(f.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)({method:"get",url:"/updateselectworking/"+t+"/"+n}).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)}),getSagfetyList:(r=Object(f.a)(regeneratorRuntime.mark((function e(){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/safety").then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}},621:function(e,t,n){"use strict";var r,o,c,m,l,d=n(4),f=(n(57),n(9));t.a={getCheckIn:(l=Object(d.a)(regeneratorRuntime.mark((function e(t,n,r,o){var c,m,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new FormData,m={headers:{"content-type":"multipart/form-data"}},c.append("company_id",t),c.append("mem_id",n),c.append("start",r),c.append("stop",o),e.next=8,f.a.post("/checkin",c,m).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 8:return data=e.sent,e.abrupt("return",data);case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return l.apply(this,arguments)}),getday:(m=Object(d.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/timeline_day/"+t+"/"+n).then((function(e){return e})).catch((function(e){return e}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)}),getTimeline:(c=Object(d.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/timeline/"+t+"/"+n).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 2:return data=e.sent,e.abrupt("return",data);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)}),saveCheckPoint:(o=Object(d.a)(regeneratorRuntime.mark((function e(t){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,r={headers:{"content-type":"multipart/form-data"}},n.append("checkpoint",JSON.stringify(t)),e.next=5,f.a.post("/checkpoint",n,r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)}),saveCheckIn:(r=Object(d.a)(regeneratorRuntime.mark((function e(t){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,r={headers:{"content-type":"multipart/form-data"}},n.append("checkpoint",JSON.stringify(t)),e.next=5,f.a.post("/checkpoint_checkin",n,r).then((function(e){return e})).catch((function(e){self.error="Unknown Error. Please check details and try again."}));case 5:return data=e.sent,e.abrupt("return",data);case 7:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}},701:function(e,t,n){"use strict";var r={props:{bottomNav:{default:String},member_travel:{default:Object}},data:function(){return{title:"Queue"}},mounted:function(){localStorage.title&&(this.title=localStorage.title)}},o=n(30),c=n(112),m=n.n(c),l=n(927),d=n(524),f=n(457),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-bottom-navigation",{staticClass:"pa-2",attrs:{grow:"",absolute:"",color:"teal"},model:{value:e.bottomNav,callback:function(t){e.bottomNav=t},expression:"bottomNav"}},[n("v-btn",{attrs:{text:"",color:"teal",link:"",to:"/esafety/home/main"}},[n("span",[e._v("Profile")]),e._v(" "),n("v-icon",[e._v("mdi-account")])],1),e._v(" "),n("v-btn",{attrs:{text:"",color:"teal",link:"",to:"/esafety/home/qr-scan"}},[n("span",[e._v("QR SCAN")]),e._v(" "),n("v-icon",[e._v("mdi-qrcode-scan")])],1),e._v(" "),n("v-btn",{attrs:{text:"",color:"teal",link:"",to:"/esafety/home/queue"}},["1"==e.member_travel.mem_type||"4"==e.member_travel.mem_type?n("span",[e._v("Check-In")]):"8"==e.member_travel.mem_type||"9"==e.member_travel.mem_type?n("span",[e._v("Med. Que")]):"7"==e.member_travel.mem_type||"10"==e.member_travel.mem_type||"11"==e.member_travel.mem_type?n("span",[e._v("Report")]):n("span",[e._v(e._s(e.title))]),e._v(" "),n("v-icon",[e._v("mdi-tray-full")])],1),e._v(" "),n("v-btn",{attrs:{text:"",color:"teal",link:"",to:"/esafety/travelplan",disabled:""}},[n("span",{staticClass:"grey--text"},[e._v("Travel Plan")]),e._v(" "),n("v-icon",{attrs:{color:"blue-grey"}},[e._v("mdi-airplane")])],1)],1)}),[],!1,null,null,null);t.a=component.exports;m()(component,{VBottomNavigation:l.a,VBtn:d.a,VIcon:f.a})}}]);